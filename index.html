<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ParaMemo 1.0.11</title>
<style>
Â  body {
Â  Â  background: #1E1F40;
Â  Â  color: #FFFFFF;
Â  Â  font-family: monospace;
Â  Â  display: flex;
Â  Â  flex-direction: column;
Â  Â  align-items: center;
Â  Â  padding: 20px;
Â  }
Â  h1 {
Â  Â  font-size: 2.5rem; /* Larger heading */
Â  }
Â  #console {
Â  Â  background: #0C0E1B;
Â  Â  width: 90%;
Â  Â  max-width: 600px;
Â  Â  height: 400px;
Â  Â  overflow-y: auto;
Â  Â  padding: 15px; /* Increased padding */
Â  Â  border-radius: 8px;
Â  Â  margin-bottom: 10px;
Â  Â  white-space: normal;
Â  Â  font-size: 1.2rem; /* Larger console text */
Â  }
Â  input[type="text"] {
Â  Â  width: 90%;
Â  Â  max-width: 600px;
Â  Â  padding: 15px; /* Increased padding */
Â  Â  font-family: monospace;
Â  Â  font-size: 1.2rem; /* Larger input text */
Â  Â  border-radius: 5px;
Â  Â  border: none;
Â  }
Â  input[type="text"].disabled {
Â  Â  background-color: #555;
Â  Â  cursor: not-allowed;
Â  }
Â  button {
Â  Â  margin-top: 10px;
Â  Â  padding: 10px 20px; /* Increased padding */
Â  Â  font-family: monospace;
Â  Â  font-size: 1.2rem; /* Larger button text */
Â  Â  border-radius: 5px;
Â  Â  border: none;
Â  Â  background: #AB5DCE;
Â  Â  color: white;
Â  Â  cursor: pointer;
Â  }
Â  button:hover { background: #FF69B4; }
Â  button:disabled {
Â  Â  background: #555;
Â  Â  cursor: not-allowed;
Â  }
</style>
</head>
<body>

<h1>ParaMemo 1.0.11</h1>
<div id="console"></div>
<input type="text" id="userInput" placeholder="Paste your paragraph, then press Submit" autofocus />
<button id="submitBtn">Submit</button>

<script>
const consoleDiv = document.getElementById('console');
const userInputÂ  Â = document.getElementById('userInput');
const submitBtnÂ  Â = document.getElementById('submitBtn');

let text = '';
let words = [];
let currentIndex = 1;
let correctCount = 0;
let state = 'inputParagraph';

// Escape HTML so user input is safe
function escapeHTML(s) {
Â  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
}

function appendConsole(msg = '', newline = true) {
Â  const safe = escapeHTML(msg);
Â  consoleDiv.innerHTML += newline ? (safe + '<br>') : (safe + ' ');
Â  consoleDiv.scrollTop = consoleDiv.scrollHeight;
}

function clearConsole() {
Â  consoleDiv.innerHTML = '<br>'.repeat(40);
}

function norm(s) {
Â  return s.toLowerCase().trim().replace(/\s+/g, ' ');
}

function disableInput() {
Â  userInput.disabled = true;
Â  userInput.classList.add('disabled');
}

function enableInput() {
Â  userInput.disabled = false;
Â  userInput.classList.remove('disabled');
Â  userInput.focus();
}

function disableSubmit() {
Â  submitBtn.disabled = true;
}

function enableSubmit() {
Â  submitBtn.disabled = false;
}

function showWords(wordsToShow, callback) {
Â  let i = 0;
Â  function showNext() {
Â  Â  if (i < wordsToShow.length) {
Â  Â  Â  appendConsole(wordsToShow[i], false);
Â  Â  Â  i++;
Â  Â  Â  setTimeout(showNext, 400);
Â  Â  } else {
Â  Â  Â  appendConsole('');
Â  Â  Â  callback();
Â  Â  }
Â  }
Â  showNext();
}

function practiceStep() {
Â  disableInput();
Â  disableSubmit();
Â  const shownWords = words.slice(0, currentIndex);
Â  clearConsole();
Â  appendConsole(`Memorize the first ${currentIndex} words:`);
Â  appendConsole(shownWords.join(' '));
Â  setTimeout(() => {
Â  Â  clearConsole();
Â  Â  appendConsole(`Type the first ${currentIndex} words and press Submit:`);
Â  Â  state = 'waitingPracticeInput';
Â  Â  enableInput();
Â  Â  enableSubmit();
Â  }, 2000);
}

function finalScoreStep() {
Â  clearConsole();
Â  appendConsole('Now enter the full paragraph and press Submit:');
Â  state = 'waitingFinalInput';
Â  enableInput();
Â  enableSubmit();
}

submitBtn.addEventListener('click', () => {
Â  disableInput();
Â  disableSubmit();
Â  const input = userInput.value;
Â  userInput.value = '';

Â  if (state === 'inputParagraph') {
Â  Â  text = input;
Â  Â  words = text.trim().split(/\s+/);
Â  Â  appendConsole('Paragraph saved. Starting practice...');
Â  Â  practiceStep();
Â  }
Â  else if (state === 'waitingPracticeInput') {
Â  Â  const shown = words.slice(0, currentIndex).join(' ');
Â  Â  if (norm(input) === norm(shown)) {
Â  Â  Â  appendConsole('âœ… Correct!');
Â  Â  Â  correctCount++;
Â  Â  Â  currentIndex++;
Â  Â  Â  if (currentIndex <= words.length) {
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  clearConsole();
Â  Â  Â  Â  Â  practiceStep();
Â  Â  Â  Â  }, 700);
Â  Â  Â  } else {
Â  Â  Â  Â  appendConsole('Practice complete!');
Â  Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  Â  clearConsole();
Â  Â  Â  Â  Â  finalScoreStep();
Â  Â  Â  Â  }, 1500);
Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  appendConsole('âŒ Wrong! Try again.');
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  clearConsole();
Â  Â  Â  Â  practiceStep();
Â  Â  Â  }, 700);
Â  Â  }
Â  }
Â  else if (state === 'waitingFinalInput') {
Â  Â  if (norm(input) === norm(text)) {
Â  Â  Â  appendConsole(`ðŸŽ‰ Final Score: ${correctCount}/${words.length} (${((correctCount/words.length)*100).toFixed(1)}%)`);
Â  Â  Â  appendConsole('You memorized it perfectly!');
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  clearConsole();
Â  Â  Â  Â  enableInput();
Â  Â  Â  Â  enableSubmit();
Â  Â  Â  }, 2000);
Â  Â  } else {
Â  Â  Â  appendConsole('âŒ Incorrect. You can retry the paragraph or redo practice.');
Â  Â  Â  setTimeout(() => {
Â  Â  Â  Â  clearConsole();
Â  Â  Â  Â  appendConsole('Type 1 to retry final input, 2 to redo practice, then press Submit:');
Â  Â  Â  Â  state = 'finalScoreChoice';
Â  Â  Â  Â  enableInput();
Â  Â  Â  Â  enableSubmit();
Â  Â  Â  }, 1500);
Â  Â  }
Â  }
Â  else if (state === 'finalScoreChoice') {
Â  Â  if (input.trim() === '1') {
Â  Â  Â  finalScoreStep();
Â  Â  } else if (input.trim() === '2') {
Â  Â  Â  currentIndex = 1;
Â  Â  Â  correctCount = 0;
Â  Â  Â  practiceStep();
Â  Â  } else {
Â  Â  Â  appendConsole('Invalid choice, defaulting to retry final input.');
Â  Â  Â  finalScoreStep();
Â  Â  }
Â  }
});

userInput.addEventListener('keypress', (e) => {
Â  if (e.key === 'Enter') submitBtn.click();
});

appendConsole('Paste your paragraph in the input below and press Submit to begin.');
enableInput();
enableSubmit();
</script>

</body>
</html>
